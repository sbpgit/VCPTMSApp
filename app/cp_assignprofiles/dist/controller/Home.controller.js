sap.ui.define(["cp/appf/cpassignprofiles/controller/BaseController","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/core/Fragment"],function(e,t,o,r,s,a,i,n){"use strict";var l,d;return e.extend("cp.appf.cpassignprofiles.controller.Home",{onInit:function(){l=this;l.oListModel=new r;l.oParamModel=new r;l.oAlgoListModel=new r},onAfterRendering:function(){l=this;l.oList=this.byId("profList");l.oList.removeSelections();if(l.oList.getBinding("items")){l.oList.getBinding("items").filter([])}this.getData()},getData:function(){this.getModel("BModel").read("/getProfiles",{success:function(e){l.oListModel.setData({results:e.results});l.oList.setModel(l.oListModel)},error:function(){t.show("Failed to get profiles")}})},onSearch:function(e){var t=e.getParameter("value")||e.getParameter("newValue"),o=[];if(t!==""){o.push(new s({filters:[new s("PROFILE",a.Contains,t),new s("PRF_DESC",a.Contains,t),new s("METHOD",a.Contains,t)],and:false}))}l.oList.getBinding("items").filter(o)},onParameters:function(e){var o=e.getSource().getParent().getCells()[0].getTitle();var r=e.getSource().getParent().getCells()[1].getText();var i="Parameters "+" "+" - "+o+" "+" - "+r;if(!l._onParameter){l._onParameter=sap.ui.xmlfragment("cp.appf.cpassignprofiles.view.Parameter",l);l.getView().addDependent(l._onParameter)}l._onParameter.setTitleAlignment("Center");l._onParameter.setTitle(i);l.paramList=sap.ui.getCore().byId("idParam");this.getModel("BModel").read("/getProfileParameters",{filters:[new s("PROFILE",a.EQ,o),new s("METHOD",a.EQ,r)],success:function(e){l.oParamModel.setData({results:e.results});l.paramList.setModel(l.oParamModel);l._onParameter.open()},error:function(){t.show("Failed to get data")}})},onParaClose:function(){l._onParameter.close()},onCreate:function(e){l.oGModel=l.getModel("oGModel");var o=e.getSource().getTooltip();l.oGModel.setProperty("/sId",o);if(o==="Copy"){var r=this.byId("profList").getSelectedItems();if(r.length){var s=r[0].getBindingContext().getProperty();l.oGModel.setProperty("/sProfile",s.PROFILE);l.oGModel.setProperty("/sProf_desc",s.PRF_DESC);l.oGModel.setProperty("/sMethod",s.METHOD);var a=sap.ui.core.UIComponent.getRouterFor(l);a.navTo("Detail",{},true)}else{t.show("Please select one row")}}else{var a=sap.ui.core.UIComponent.getRouterFor(l);a.navTo("Detail",{},true)}},onAddClose:function(){l._onAddppf.close()},onAlgorChange:function(e){var o=sap.ui.getCore().byId("idAlgo")._getSelectedItemText();l.alogoList=sap.ui.getCore().byId("idTab");var r=new s("METHOD",a.EQ,o);this.getModel("PModel").read("/get_palparameters",{filters:[r],success:function(e){e.results.forEach(function(e){e.FLAG=e.DATATYPE},l);l.oAlgoListModel.setData({results:e.results});l.alogoList.setModel(l.oAlgoListModel)},error:function(){t.show("Failed to get data")}})}})});