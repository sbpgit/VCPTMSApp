sap.ui.define(["cp/appf/cpbomod/controller/BaseController","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/core/Fragment"],function(e,t,o,a,r,s,n,d){"use strict";var i,l;return e.extend("cp.appf.cpbomod.controller.ItemDetail",{onInit:function(){i=this;this.bus=sap.ui.getCore().getEventBus();i.oBomModel=new a;i.oCharModel=new a;this.oBomModel.setSizeLimit(1e3);this.oCharModel.setSizeLimit(1e3);l=i.getOwnerComponent().getModel("oGModel")},onAfterRendering:function(){l=i.getOwnerComponent().getModel("oGModel");sap.ui.core.BusyIndicator.show();var e=l.getProperty("/prdId");var o=l.getProperty("/locId");this.getModel("BModel").read("/getBomOdCond",{filters:[new r("LOCATION_ID",s.EQ,o),new r("PRODUCT_ID",s.EQ,e)],success:function(e){if(e.results.length===0){var t=[];i.oBomModel.setData({results:t});i.oCharModel.setData({charResults:t});i.byId("idChartab").setModel(i.oCharModel);i.onbomSearch()}else{i.oBomModel.setData({results:e.results});i.byId("idBom").setModel(i.oBomModel);i.byId("idBom").removeSelections(true);i.byId("idBomPanel").setExpanded(true);i.byId("idCharPanel").setExpanded(false);i.onbomSearch()}i.byId("bomSearch").setValue("");sap.ui.core.BusyIndicator.hide()},error:function(){t.show("Failed to get data")}})},onItemPress:function(){sap.ui.core.BusyIndicator.show();var e=this.byId("idBom").getSelectedItem().getCells()[2].getText();l.setProperty("/objdep",e);this.getModel("BModel").read("/getODcharval",{filters:[new r("OBJ_DEP",s.EQ,e)],success:function(e){i.oCharModel.setData({charResults:e.results});i.byId("idChartab").setModel(i.oCharModel);i.byId("idBomPanel").setExpanded(false);i.byId("idCharPanel").setExpanded(true);i.byId("charSearch").setValue("");i.oncharSearch();sap.ui.core.BusyIndicator.hide()},error:function(){t.show("Failed to get data")}})},onbomSearch:function(e){var t="",o=[];if(e){var t=e.getParameter("value")||e.getParameter("newValue")}if(t!==""){o.push(new r({filters:[new r("ITEM_NUM",s.Contains,t),new r("OBJ_DEP",s.Contains,t)],and:false}))}i.byId("idBom").getBinding("items").filter(o)},oncharSearch:function(e){var t="",o=[];if(e){var t=e.getParameter("value")||e.getParameter("newValue")}if(t!==""){o.push(new r({filters:[new r("CLASS_NAME",s.Contains,t),new r("CHAR_NAME",s.Contains,t)],and:false}))}i.byId("idChartab").getBinding("items").filter(o)}})});