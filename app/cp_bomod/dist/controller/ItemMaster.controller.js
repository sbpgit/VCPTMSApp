sap.ui.define(["cp/appf/cpbomod/controller/BaseController","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/ui/Device"],function(e,t,s,i,o,a,r){"use strict";var n,l;return e.extend("cp.appf.cpbomod.controller.ItemMaster",{onInit:function(){n=this;n.oModel=new s;this.bus=sap.ui.getCore().getEventBus();this.bus.subscribe("data","refreshMaster",this.refreshMaster,this);this.bus.publish("nav","toBeginPage",{viewName:this.getView().getProperty("viewName")})},refreshMaster:function(){this.onAfterRendering()},onAfterRendering:function(){n=this;l=this.getModel("oGModel");sap.ui.core.BusyIndicator.show();this.getModel("BModel").read("/getProdClass",{success:function(e){n.oModel.setData({results:e.results});n.byId("bomList").setModel(n.oModel);l.setProperty("/prdId",e.results[0].PRODUCT_ID);l.setProperty("/locId",e.results[0].LOCATION_ID);n.byId("bomList").setSelectedItem(n.byId("bomList").getItems()[0],true);n.onhandlePress();sap.ui.core.BusyIndicator.hide()},error:function(){t.show("Failed to get data")}})},onhandlePress:function(e){l=this.getModel("oGModel");if(e){var t=e.getSource().getSelectedItem().getBindingContext().getObject();l.setProperty("/prdId",t.PRODUCT_ID);l.setProperty("/locId",t.LOCATION_ID)}n.getOwnerComponent().runAsOwner(function(){if(!n.oDetailView){try{n.oDetailView=sap.ui.view({viewName:"cp.appf.cpbomod.view.ItemDetail",type:"XML"});n.bus.publish("flexible","addDetailPage",n.oDetailView);n.bus.publish("nav","toDetailPage",{viewName:n.oDetailView.getViewName()})}catch(e){n.oDetailView.onAfterRendering()}}else{n.bus.publish("nav","toDetailPage",{viewName:n.oDetailView.getViewName()})}})},onSearch:function(e){var t=e.getParameter("value")||e.getParameter("newValue"),s=[];if(t!==""){s.push(new i({filters:[new i("PRODUCT_ID",o.Contains,t),new i("LOCATION_ID",o.Contains,t)],and:false}))}n.byId("bomList").getBinding("items").filter(s)}})});