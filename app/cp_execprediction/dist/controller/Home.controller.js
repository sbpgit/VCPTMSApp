sap.ui.define(["sap/ui/core/mvc/Controller","cp/execpred/cpexecprediction/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,i,o,s,l,n){"use strict";var d,a;return t.extend("cp.execpred.cpexecprediction.controller.Home",{onInit:function(){this.locModel=new i;this.prodModel=new i;this.odModel=new i;this.ppfModel=new i;this._oCore=sap.ui.getCore();if(!this._valueHelpDialogLoc){this._valueHelpDialogLoc=sap.ui.xmlfragment("cp.execpred.cpexecprediction.view.LocDialog",this);this.getView().addDependent(this._valueHelpDialogLoc)}if(!this._valueHelpDialogProd){this._valueHelpDialogProd=sap.ui.xmlfragment("cp.execpred.cpexecprediction.view.ProdDialog",this);this.getView().addDependent(this._valueHelpDialogProd)}if(!this._valueHelpDialogOD){this._valueHelpDialogOD=sap.ui.xmlfragment("cp.execpred.cpexecprediction.view.ObjDepDialog",this);this.getView().addDependent(this._valueHelpDialogOD)}if(!this._valueHelpDialogPPF){this._valueHelpDialogPPF=sap.ui.xmlfragment("cp.execpred.cpexecprediction.view.PredProfileDialog",this);this.getView().addDependent(this._valueHelpDialogPPF)}this.getRouter().getRoute("Home").attachPatternMatched(this._onPatternMatched.bind(this))},_onPatternMatched:function(){a=this;this.oGModel=this.getModel("GModel");this.oLoc=this.byId("locInput");this.oProd=this.byId("prodInput");this.oObjDep=this.byId("odInput");this.oPredProfile=this.byId("pmInput");this.aVcRulesList=[];this.oProdList=this._oCore.byId(this._valueHelpDialogProd.getId()+"-list");this.oLocList=this._oCore.byId(this._valueHelpDialogLoc.getId()+"-list");this.oODList=this._oCore.byId(this._valueHelpDialogOD.getId()+"-list");this.oPPFList=this._oCore.byId(this._valueHelpDialogPPF.getId()+"-list");this.getModel("BModel").read("/getLocation",{success:function(e){a.locModel.setData(e);a.oLocList.setModel(a.locModel)},error:function(e,t){l.show("error")}});this.getModel("BModel").read("/getProducts",{success:function(e){a.prodModel.setData(e);a.oProdList.setModel(a.prodModel)},error:function(e,t){l.show("error")}});this.getModel("BModel").read("/getODHdr",{success:function(e){a.odModel.setData(e);a.oODList.setModel(a.odModel)},error:function(e,t){l.show("error")}});this.getModel("BModel").read("/getODHdr",{success:function(e){a.odModel.setData(e);a.oODList.setModel(a.odModel)},error:function(e,t){l.show("error")}})},onRun:function(){var e=this.getModel("PModel"),t=[];var i={vcRulesList:[]};var o={Location:"FR10",Product:"KM_M219VBVS_BVS",GroupID:"M219VV00105NN_1"};i.vcRulesList.push(o);e.create("/generateRegModels",i,{success:function(e){l.show("success")},error:function(e){l.show("error")}})},handleValueHelp:function(e){var t=e.getParameter("id");if(t.includes("loc")){this._valueHelpDialogLoc.open()}else if(t.includes("prod")){this._valueHelpDialogProd.open()}else if(t.includes("od")){if(this.oODList.getBinding("items")){this.oODList.getBinding("items").filter([new o("LOCATION_ID",s.Contains,a.oLocList.getSelectedItem().getTitle()),new o("PRODUCT_ID",s.Contains,a.oProdList.getSelectedItem().getTitle())])}this._valueHelpDialogOD.open()}},handleClose:function(e){var t=e.getParameter("id");if(t.includes("loc")){a._oCore.byId(this._valueHelpDialogLoc.getId()+"-searchField").setValue("");if(a.oLocList.getBinding("items")){a.oLocList.getBinding("items").filter([])}}else if(t.includes("prod")){a._oCore.byId(this._valueHelpDialogProd.getId()+"-searchField").setValue("");if(a.oProdList.getBinding("items")){a.oProdList.getBinding("items").filter([])}}else if(t.includes("od")){a._oCore.byId(this._valueHelpDialogOD.getId()+"-searchField").setValue("");if(a.oODList.getBinding("items")){a.oODList.getBinding("items").filter([])}}else{}},handleSearch:function(e){var t=e.getParameter("value")||e.getParameter("newValue"),i=e.getParameter("id"),l=[];t=t?t.trim():"";if(i.includes("loc")){if(t!==""){l.push(new o({filters:[new o("LOCATION_ID",s.Contains,t),new o("LOCATION_DESC",s.Contains,t)],and:false}))}a.oLocList.getBinding("items").filter(l)}else if(i.includes("prod")){if(t!==""){l.push(new o({filters:[new o("PRODUCT_ID",s.Contains,a.oAdminList.getSelectedItem().getTitle()),new o("PROD_DESC",s.Contains,t)],and:false}))}a.oProdList.getBinding("items").filter(l)}else if(i.includes("od")){if(t!==""){l.push(new o({filters:[new o("LOCATION_ID",s.Contains,t),new o("PRODUCT_ID",s.Contains,t),new o("COMPONENT",s.Contains,t),new o("OBJ_DEP",s.Contains,t)],and:false}))}a.oODList.getBinding("items").filter(l)}else{}},handleSelection:function(e){var t=e.getParameter("id"),i=e.getParameter("selectedItems"),o;if(t.includes("Loc")){o=e.getParameter("selectedItems");a.oLoc.setValue(o[0].getTitle())}else if(t.includes("prod")){a.oProdList.getBinding("items").filter([]);o=e.getParameter("selectedItems");if(o&&o.length>0){o.forEach(function(e){a.oProd.addToken(new sap.m.Token({key:e.getTitle(),text:e.getTitle()}))})}}else if(t.includes("od")){a.oODList.getBinding("items").filter([]);o=e.getParameter("selectedItems");if(o&&o.length>0){o.forEach(function(e){a.oObjDep.addToken(new sap.m.Token({key:e.getTitle(),text:e.getTitle()}))})}}else{}a.handleClose(e)}})});