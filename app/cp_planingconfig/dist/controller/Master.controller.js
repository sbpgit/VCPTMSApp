sap.ui.define(["sap/ui/core/mvc/Controller","cpapp/cpplaningconfig/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/f/library","sap/ui/Device"],function(e,t,i,o,a,n,s){"use strict";var r,l;return t.extend("cpapp.cpplaningconfig.controller.Master",{onInit(){r=this;r.locModel=new i;r.locModel.setSizeLimit(1e3);this.bus=sap.ui.getCore().getEventBus();this.bus.subscribe("data","refreshMaster",this.refreshMaster,this);this.bus.publish("nav","toBeginPage",{viewName:this.getView().getProperty("viewName")})},onAfterRendering:function(){r=this;l=this.getModel("oGModel");r.oLocationList=r.getView().byId("idLocationsList");r.getLocation()},getLocation:function(){r.getModel("PCModel").read("/getLocation",{success:function(e){r.locModel.setData({locations:e.results});r.oLocationList.setModel(r.locModel)},error:function(e,t){MessageToast.show("error");sap.ui.core.BusyIndicator.hide()}})},onSearchLocation:function(e){var t=[];r.oLocationList=r.getView().byId("idLocationsList");var i=e.getParameter("value")||e.getParameter("newValue");if(i){t=new o([new o("LOCATION_ID",a.Contains,i),new o("LOCATION_DESC",a.Contains,i)],false);r.oLocationList.getBinding("items").filter(t)}else{r.oLocationList.getBinding("items").filter(t)}},onListItemPress:function(e){l=r.getModel("oGModel");if(e){var t=e.getParameter("listItem").getProperty("title");l.setProperty("/location",t)}r.getOwnerComponent().runAsOwner(function(){if(!r.oDetailView){try{r.oDetailView=sap.ui.view({viewName:"cpapp.cpplaningconfig.view.Home",type:"XML"});r.bus.publish("flexible","addDetailPage",r.oDetailView);r.bus.publish("nav","toDetailPage",{viewName:r.oDetailView.getViewName()})}catch(e){r.oDetailView.onAfterRendering()}}else{r.bus.publish("nav","toDetailPage",{viewName:r.oDetailView.getViewName()})}})}})});