sap.ui.define(["cpapp/cpmatvariant/controller/BaseController","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/ui/Device","../model/formatter"],function(e,t,a,s,i,o,r,l){"use strict";var d,n;return e.extend("cpapp.cpmatvariant.controller.ItemMaster",{formatter:l,onInit:function(){d=this;d.selectedArray=[];d.indexArray=[];d.oIndexArray=[];d.oModel=new a;this.locModel=new a;this.prodModel=new a;d.oGModel=d.getOwnerComponent().getModel("oGModel");d.oCharModel=new a;d.charnameModel=new a;d.charvalueModel=new a;d.locModel.setSizeLimit(1e3);d.prodModel.setSizeLimit(1e3);this.oModel.setSizeLimit(1e3);this.bus=sap.ui.getCore().getEventBus();this.bus.subscribe("data","refreshMaster",this.refreshMaster,this);this.bus.publish("nav","toBeginPage",{viewName:this.getView().getProperty("viewName")});this._oCore=sap.ui.getCore();if(!this._valueHelpDialogLoc){this._valueHelpDialogLoc=sap.ui.xmlfragment("cpapp.cpmatvariant.view.LocDialog",this);this.getView().addDependent(this._valueHelpDialogLoc)}if(!this._valueHelpDialogProd){this._valueHelpDialogProd=sap.ui.xmlfragment("cpapp.cpmatvariant.view.ProdDialog",this);this.getView().addDependent(this._valueHelpDialogProd)}if(!this._valueHelpDialogDescUpdate){this._valueHelpDialogDescUpdate=sap.ui.xmlfragment("cpapp.cpmatvariant.view.UniqueDescUpdate",this);this.getView().addDependent(this._valueHelpDialogDescUpdate)}if(!this._addCharacteristic){this._addCharacteristic=sap.ui.xmlfragment("cpapp.cpmatvariant.view.AddCharacterstics",this);this.getView().addDependent(this._addCharacteristic)}if(!this._createCharacterstics){this._createCharacterstics=sap.ui.xmlfragment("cpapp.cpmatvariant.view.CreateChar",this);this.getView().addDependent(this._createCharacterstics)}if(!this._copyCharacterstics){this._copyCharacterstics=sap.ui.xmlfragment("cpapp.cpmatvariant.view.CopyChar",this);this.getView().addDependent(this._copyCharacterstics)}if(!this._valueHelpDialogclassName){this._valueHelpDialogclassName=sap.ui.xmlfragment("cpapp.cpmatvariant.view.className",this);this.getView().addDependent(this._valueHelpDialogclassName)}},refreshMaster:function(){this.onAfterRendering()},onAfterRendering:function(){d=this;d.oLoc=this.byId("idloc");this.oProd=this.byId("prodInput");d._valueHelpDialogLoc.setTitleAlignment("Center");d._valueHelpDialogProd.setTitleAlignment("Center");d.oTableData=[];sap.ui.getCore().byId("idUniqDesc1").setValue("");d.ListModel=new a;d.ListModel.setData({results:d.oTableData});sap.ui.getCore().byId("idCharItem").setModel(d.ListModel);this.oProdList=sap.ui.getCore().byId("prodSlctList");this.oLocList=sap.ui.getCore().byId("LocSlctList");n=this.getModel("oGModel");n.setProperty("/New","");sap.ui.core.BusyIndicator.show();this.getModel("BModel").read("/getLocation",{success:function(e){sap.ui.core.BusyIndicator.hide();d.locModel.setData(e);d.oLocList.setModel(d.locModel)},error:function(e,a){sap.ui.core.BusyIndicator.hide();t.show("error")}})},handleValueHelp:function(e){var a=e.getParameter("id");n.setProperty("/mainSID",a);if(a.includes("loc")){d._valueHelpDialogLoc.open()}else if(a.includes("prod")){if(d.byId("idloc").getValue()!==""){d._valueHelpDialogProd.open()}else{t.show("Select Location")}}},handleClose:function(e){var t=e.getSource().getParent().mAssociations.initialFocus.split("-")[0];if(t.includes("Loc")){sap.ui.getCore().byId("LocSearch").setValue("");if(d.oLocList.getBinding("items")){d.oLocList.getBinding("items").filter([])}sap.ui.getCore().byId("LocSlctList").removeSelections();d._valueHelpDialogLoc.close()}else if(t.includes("Prod")){sap.ui.getCore().byId("ProdSearch").setValue("");if(d.oProdList.getBinding("items")){d.oProdList.getBinding("items").filter([])}sap.ui.getCore().byId("prodSlctList").removeSelections();d._valueHelpDialogProd.close()}},handleSearch:function(e){var t=e.getParameter("value")||e.getParameter("newValue"),a=e.getParameter("id"),o=[];t=t?t.trim():"";if(a.includes("Loc")){if(t!==""){o.push(new s({filters:[new s("LOCATION_ID",i.Contains,t),new s("LOCATION_DESC",i.Contains,t)],and:false}))}d.oLocList.getBinding("items").filter(o)}else if(a.includes("Prod")){if(t!==""){o.push(new s({filters:[new s("PRODUCT_ID",i.Contains,t),new s("PROD_DESC",i.Contains,t)],and:false}))}d.oProdList.getBinding("items").filter(o)}},handleSelection:function(e){var a=e.getParameter("id"),o=n.getProperty("/mainSID"),r=e.getParameter("selectedItems"),l,c=[];this.oLoc=d.byId("idloc");this.oProd=d.byId("prodInput");if(a.includes("Loc")){l=e.getParameter("selectedItems");d.oLoc.setValue(e.getParameters().listItem.getCells()[0].getTitle());d.oProd.setValue("");this.getModel("BModel").read("/getLocProdDet",{filters:[new s("LOCATION_ID",i.EQ,e.getParameters().listItem.getCells()[0].getTitle())],success:function(e){d.prodModel.setData(e);d.oProdList.setModel(d.prodModel)},error:function(e,a){t.show("error")}})}else if(a.includes("prod")){l=e.getParameter("selectedItems");d.oProd.setValue(e.getParameters().listItem.getCells()[0].getTitle())}d.handleClose(e)},onGetData:function(e){var a=d.oLoc.getValue(),o=d.oProd.getValue(),r=d.byId("idUnique").getSelectedKey();n.setProperty("/prdId","");n.setProperty("/locId","");n.setProperty("/uniqId","");var l=[];l.push(new s({filters:[new s("LOCATION_ID",i.EQ,a),new s("PRODUCT_ID",i.EQ,o)],and:true}));if(r!=="A"){l.push(new s({filters:[new s("UID_TYPE",i.EQ,r)],and:true}))}if(a!==""&&o!==""){this.byId("idMatSearch").setValue("");if(d.byId("idMatVHead").getItems().length){d.byId("idMatVHead").getBinding("items").filter(l)}sap.ui.core.BusyIndicator.show();this.getModel("BModel").read("/getUniqueHeader",{filters:[l],success:function(e){sap.ui.core.BusyIndicator.hide();if(e.results.length){d.oModel.setData({results:e.results});n.setProperty("/uniqueData",e.results);d.byId("idMatVHead").setModel(d.oModel);n.setProperty("/locId",e.results[0].LOCATION_ID);n.setProperty("/prdId",e.results[0].PRODUCT_ID);n.setProperty("/uniqId",e.results[0].UNIQUE_ID);n.setProperty("/uid_rate",e.results[0].UID_RATE);d.byId("idMatVHead").setSelectedItem(d.byId("idMatVHead").getItems()[0],true);d.byId("idCreateBtn").setVisible(true);d.byId("idCopyBtn").setVisible(true)}else{d.oModel.setData({results:[]});n.setProperty("/uniqueData",e.results);d.byId("idMatVHead").setModel(d.oModel);t.show("No data for the selected Location Product")}d.byId("idCreateBtn").setVisible(true);d.byId("idCopyBtn").setVisible(true);d.onhandlePress()},error:function(){sap.ui.core.BusyIndicator.hide();t.show("Failed to get data")}})}else{t.show("Please select Location and Product")}},onhandlePress:function(e){n=this.getModel("oGModel");if(e){var t=e.getSource().getSelectedItem().getBindingContext().getObject();n.setProperty("/prdId",t.PRODUCT_ID);n.setProperty("/locId",t.LOCATION_ID);n.setProperty("/uniqId",t.UNIQUE_ID);n.setProperty("/uid_rate",t.UID_RATE);n.setProperty("/uid_active",t.ACTIVE)}d.getOwnerComponent().runAsOwner(function(){if(!d.oDetailView){try{d.oDetailView=sap.ui.view({viewName:"cpapp.cpmatvariant.view.ItemDetail",type:"XML"});d.bus.publish("flexible","addDetailPage",d.oDetailView);d.bus.publish("nav","toDetailPage",{viewName:d.oDetailView.getViewName()})}catch(e){d.oDetailView.onAfterRendering()}}else{d.bus.publish("nav","toDetailPage",{viewName:d.oDetailView.getViewName()})}})},onSearch:function(e){var t=e.getParameter("value")||e.getParameter("newValue"),a=[];if(t!==""){a.push(new s({filters:[new s("UNIQUE_DESC",i.Contains,t),new s("UNIQUE_ID",i.EQ,t)],and:false}))}d.byId("idMatVHead").getBinding("items").filter(a)},onEditDesc:function(e){var t=e.getSource().getParent().getBindingContext().getObject();n.setProperty("/SelectedData",t);n.setProperty("/SelectedId",t.UNIQUE_ID);n.setProperty("/SelectedDesc",t.UNIQUE_DESC);n.setProperty("/SelectedURate",t.UID_RATE);this._valueHelpDialogDescUpdate.open()},onCloseDesc:function(){this._valueHelpDialogDescUpdate.close()},onUpdateUniqueDesc:function(){var e=n.getProperty("/SelectedData");var a=sap.ui.getCore().byId("idUniqDesc").getValue();var s;if(e.ACTIVE===true){s=""}else{s="X"}d.getModel("BModel").callFunction("/changeUnique",{method:"GET",urlParameters:{LOCATION_ID:e.LOCATION_ID,PRODUCT_ID:e.PRODUCT_ID,UNIQUE_ID:parseInt(e.UNIQUE_ID),UID_TYPE:e.UID_TYPE,UNIQUE_DESC:a,ACTIVE:s,FLAG:"E"},success:function(e){sap.ui.core.BusyIndicator.hide();t.show(e.changeUnique);d.onCloseDesc();d.onGetData()},error:function(e){sap.ui.core.BusyIndicator.hide();t.show("Failed to changes the status")}})},onChange:function(e){var a=e.getSource().getBindingContext().getObject();var s;if(a.ACTIVE===true){s="X"}else{s=""}d.getModel("BModel").callFunction("/changeUnique",{method:"GET",urlParameters:{LOCATION_ID:a.LOCATION_ID,PRODUCT_ID:a.PRODUCT_ID,UNIQUE_ID:parseInt(a.UNIQUE_ID),UID_TYPE:a.UID_TYPE,UNIQUE_DESC:a.UNIQUE_DESC,ACTIVE:s,FLAG:"E"},success:function(e){sap.ui.core.BusyIndicator.hide();t.show(e.changeUnique);d.onGetData()},error:function(e){sap.ui.core.BusyIndicator.hide();t.show("Failed to changes the status")}})},onCreateBtn:function(){d.selectedArray=[];d.oTableData=[];sap.ui.getCore().byId("idUniqDesc1").setValue("");d.ListModel=new a;d.ListModel.setData({results:d.oTableData});sap.ui.getCore().byId("idCharItem").setModel(d.ListModel);var e=this.byId("idloc").getValue(),s=this.byId("prodInput").getValue(),i=this.byId("idUnique").getSelectedKey();sap.ui.getCore().byId("locId1").setValue(e);sap.ui.getCore().byId("prodId1").setValue(s);n.setProperty("/New","N");sap.ui.getCore().byId("idUniqDesc1").setValue("");d.oTableData=[];d.ListModel=new a;d.ListModel.setData({results:d.oTableData});sap.ui.getCore().byId("idCharItem").setModel(d.ListModel);if(s){d._createCharacterstics.open()}else{t.show("Please select Location/ Product")}},onCopyBtn:function(e){d.selectedArray=[];var s=d.byId("idMatVHead").getSelectedItem();if(s){var i=s.getBindingContext().getProperty();sap.ui.getCore().byId("locId1").setValue(i.LOCATION_ID);sap.ui.getCore().byId("prodId1").setValue(i.PRODUCT_ID);sap.ui.getCore().byId("idUniqDesc1").setValue(i.UNIQUE_DESC);n.setProperty("/New","C");d.oTableData=n.getProperty("/CharData");d.ListModel=new a;d.ListModel.setData({results:d.oTableData});sap.ui.getCore().byId("idCharItem").setModel(d.ListModel);d.oGModel.setProperty("/copy","X");d.oGModel.setProperty("/setData","");d._createCharacterstics.open();d.CharData()}else{t.show("Please select a uniq id to copy")}},CharData:function(){sap.ui.core.BusyIndicator.show();var e=[];var o=this.byId("prodInput").getValue();if(o){this.getModel("BModel").read("/getProdClsChar",{filters:[new s("PRODUCT_ID",i.EQ,o)],success:function(t){sap.ui.core.BusyIndicator.hide();d.oGModel.setProperty("/child","Y");for(var s=0;s<t.results.length;s++){e.push({Description:t.results[s].CLASS_NAME})}var i=e.filter((e,t,a)=>a.map(e=>e.Description).indexOf(e.Description)==t);var o=i;var r;var l=[];var n={};var c=[];var u=[];for(var s=0;s<i.length;s++){for(var g=0;g<t.results.length;g++){if(i[s].Description===t.results[g].CLASS_NAME){c.push(t.results[g]);var p=i[s].Description;n[p]=c}}c=[]}l=n;u=l;for(var s in o){o[s].children=[]}for(var C=0;C<i.length;C++){var h=[];var I=i[C].Description;for(var D=0;D<n[I].length;D++){var y=n[I][D].CHAR_NAME;h.push({Description:y})}h=h.filter((e,t,a)=>a.map(e=>e.Description).indexOf(e.Description)==t);for(var s in h){h[s].nodes=[]}for(var f=0;f<h.length;f++){for(var m=0;m<n[I].length;m++){if(h[f].Description===n[I][m].CHAR_NAME){h[f].nodes.push({CLASS_NAME:n[I][m].CLASS_NAME,CHAR_VALUE:n[I][m].CHAR_VALUE,CHAR_NAME:n[I][m].CHAR_NAME,CHAR_NUM:n[I][m].CHAR_NUM,CHARVAL_NUM:n[I][m].CHARVAL_NUM,Description:n[I][m].CHAR_VALUE,Selected:false})}}}o[C].children=h;r=h}var M=new a;M.setData(o);d._valueHelpDialogclassName.setModel(M,"oModel");d.oGModel.setProperty("/mainData",M)},error:function(e,a){sap.ui.core.BusyIndicator.hide();t.show("error")}})}else{t.show("Please select product")}},onCloseCreate:function(){this._createCharacterstics.close()},onCloseCopy:function(){this._copyCharacterstics.close()},onAddChar:function(){var e={};if(d.oGModel.getProperty("/setData")===""||d.oGModel.getProperty("/setData")===undefined){d.CharData();sap.ui.getCore().byId("_IDGenPanel2").setExpanded(false);sap.ui.getCore().byId("idCharSearch").setValue()}if(d.oGModel.getProperty("/copy")==="X"){var t=sap.ui.getCore().byId("idCharItem").getItems();for(var s=0;s<t.length;s++){e={CHAR_NAME:t[s].getCells()[0].getText(),CHAR_NUM:t[s].getCells()[1].getText(),CHAR_VALUE:t[s].getCells()[2].getText(),CHARVAL_NUM:t[s].getCells()[3].getText()};d.selectedArray.push(e)}d.oGModel.setProperty("/copy","");var i=d.oGModel.getProperty("/mainData");var o=i.oData;for(var s=0;s<o.length;s++){for(var r=0;r<o[s].children.length;r++){for(var l=0;l<o[s].children[r].nodes.length;l++){for(var n=0;n<d.selectedArray.length;n++){if(d.selectedArray[n].CHAR_VALUE===o[s].children[r].nodes[l].CHAR_VALUE&&d.selectedArray[n].CHAR_NAME===o[s].children[r].nodes[l].CHAR_NAME){o[s].children[r].nodes[l].Selected=true}}}}}var c=new a;c.setData(o);d._valueHelpDialogclassName.setModel(c,"oModel")}d._valueHelpDialogclassName.open()},handleCharSelection:function(e){d.oGModel=d.getModel("oGModel");var t={};var s=d.selectedArray;d.ListModel=new a;d.ListModel.setData({results:s});sap.ui.getCore().byId("idCharItem").setModel(d.ListModel);d.oGModel.setProperty("/setData","X");d.oGModel.setProperty("/arrayFlag","X");d._valueHelpDialogclassName.close()},onClassClose:function(){var e=new a;e.setData([]);d._valueHelpDialogclassName.setModel(e);this._valueHelpDialogclassName.close()},handleCharSearch:function(e){let t=e.getSource().getValue();if(t.length>0){sap.ui.getCore().byId("_IDGenPanel2").setExpanded(true);let e=d.oGModel.getProperty("/mainData");let i=JSON.parse(JSON.stringify(e.oData));let o=i.filter(e=>{let a=e.children.filter(e=>{let a=e.nodes.filter(e=>{let a=t.toLowerCase();let s=e.CLASS_NAME.toLowerCase().includes(a)||e.CHAR_NAME.toLowerCase().includes(a)||e.CHAR_VALUE.toLowerCase().includes(a);return s});e.nodes=a;return a.length>0});e.children=a;return a.length>0});var s=o;let r=new a;r.setData(s);d._valueHelpDialogclassName.setModel(r,"oModel")}else{sap.ui.getCore().byId("_IDGenPanel2").setExpanded(false);d._valueHelpDialogclassName.setModel(d.oGModel.getProperty("/mainData"),"oModel")}},handleCharClose:function(e){var t=e.getParameter("id");if(t.includes("className")){d._oCore.byId(this.getId()+"-searchField").setValue("");if(d.oClassnameList.getBinding("items")){d.oClassnameList.getBinding("items").filter([])}}else if(t.includes("charName")){d._oCore.byId(this._valueHelpDialogcharName.getId()+"-searchField").setValue("");if(d.oCharnameList.getBinding("items")){d.oCharnameList.getBinding("items").filter([])}}else if(t.includes("charVal")){d._oCore.byId(this._valueHelpDialogcharValue.getId()+"-searchField").setValue("");if(d.oCharvalueList.getBinding("items")){d.oCharvalueList.getBinding("items").filter([])}}},onCloseRestItem:function(){sap.ui.getCore().byId("idClassname2").setValue("");sap.ui.getCore().byId("idCharname2").setValue("");sap.ui.getCore().byId("idCharval2").setValue("");d._addCharacteristic.close()},onAdd:function(){var e=sap.ui.getCore().byId("idCharname2").getValue(),s=sap.ui.getCore().byId("idCharno2").getValue(),i=sap.ui.getCore().byId("idCharval2").getValue(),o=sap.ui.getCore().byId("idCharvalno2").getValue(),r=sap.ui.getCore().byId("idClassname2").getValue();if(e!==""&&i!==""&&r!==""){this.oData={CLASS_NAME:r,CHAR_NAME:e,CHAR_NUM:s,CHAR_VALUE:i,CHARVAL_NUM:o,OFLAG:"X"};var l=sap.ui.getCore().byId("idCharItem").getItems();var n=0;for(var c=0;c<l.length;c++){if(l[c].getCells()[1].getText()===s&&l[c].getCells()[3].getText()===o){n=n+1}}if(n===0){d.oTableData.push(d.oData);d.ListModel=new a;d.ListModel.setData({results:d.oTableData});sap.ui.getCore().byId("idCharItem").setModel(d.ListModel);d._addCharacteristic.close()}else{sap.m.MessageToast.show("Characterstic is already maintained")}}else{t.show("Please fill all inputs")}},onTabDel:function(e){var t=e.getSource().getParent().getBindingContext().getObject();var a=e.getParameters("listItem").id.split("idCharItem-")[1];var s=d.ListModel.getData().results;s.splice(a,1);d.ListModel.refresh()},onCreateUniq:function(){var e;var t={RTRCHAR:[]};var a=sap.ui.getCore().byId("locId1").getValue(),s=sap.ui.getCore().byId("prodId1").getValue(),i=1,o=sap.ui.getCore().byId("idUniqDesc1").getValue(),r=sap.ui.getCore().byId("idComboBox1").getValue(),l=sap.ui.getCore().byId("uidRId1").getValue(),c=sap.ui.getCore().byId("idComboBox").getValue(),u="C",g=0;if(c==="True"){c=""}else{c="X"}var p=sap.ui.getCore().byId("idCharItem").getItems();var C=n.getProperty("/New");for(var h=0;h<p.length;h++){var I=p[h].getBindingContext().getObject();e={LOCATION_ID:a,PRODUCT_ID:s,UNIQUE_ID:i,UNIQUE_DESC:o,CHAR_NUM:I.CHAR_NUM,CHARVAL_NUM:I.CHARVAL_NUM};t.RTRCHAR.push(e)}sap.ui.core.BusyIndicator.show();d.getModel("BModel").callFunction("/maintainUniqueChar",{method:"GET",urlParameters:{FLAG:C,UNIQUECHAR:JSON.stringify(t.RTRCHAR)},success:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show(e.maintainUniqueChar);d.onGetData();d.onCloseCreate();d.onClassClose();d.selectedArray=[]},error:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("Error")}})},onCopyUniqueDesc:function(){var e=n.getProperty("/uniqueData");var t=sap.ui.getCore().byId("locIdCC").getValue(),a=sap.ui.getCore().byId("prodIdCC").getValue(),s=1,i=sap.ui.getCore().byId("idUniqDescCC").getValue(),o=sap.ui.getCore().byId("idComboBoxCC").getSelectedKey(),r=sap.ui.getCore().byId("uidRIdCC").getValue(),l=sap.ui.getCore().byId("idComboBoxAC").getValue(),c="C",u=0;if(l==="True"){l=""}else{l="X"}var g=sap.ui.getCore().byId("idCharItem").getItems();var p=n.getProperty("/New");for(var C=0;C<g.length;C++){var h=g[C].getBindingContext().getObject();Charlist={LOCATION_ID:t,PRODUCT_ID:a,UNIQUE_ID:s,UNIQUE_DESC:i,CHAR_NUM:h.CHAR_NUM,CHARVAL_NUM:h.CHARVAL_NUM};oEntry.RTRCHAR.push(Charlist)}sap.ui.core.BusyIndicator.show();d.getModel("BModel").callFunction("/maintainUniqueChar",{method:"GET",urlParameters:{FLAG:p,UNIQUECHAR:JSON.stringify(oEntry.RTRCHAR)},success:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show(e.maintainUniqueChar);d.onGetData();d.onCloseCreate();d.onClassClose()},error:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("Error")}});if(t===""||a===""){sap.m.MessageToast.show("Please select Location/Product")}else{sap.ui.core.BusyIndicator.show();var I=d.getView().getModel("BModel");I.callFunction("/maintainUniqueChar",{method:"GET",urlParameters:{LOCATION_ID:t,PRODUCT_ID:a,UNIQUE_ID:s,UID_TYPE:o,UNIQUE_DESC:i,ACTIVE:l,FLAG:"C"},success:function(e){sap.m.MessageToast.show(e.changeUnique);d.onAfterRendering();d._copyCharacterstics.close();d.onGetData();sap.ui.core.BusyIndicator.hide()},error(e){sap.m.MessageToast.show("Failed to Create");sap.ui.core.BusyIndicator.hide()}})}},onSelect:function(e){d.oIndexArray=[];if(d.oGModel.getProperty("/arrayFlag")==="X"){d.indexArray=[];d.oGModel.setProperty("/arrayFlag","")}var t=e.getSource().getSelectedButton().getBindingContext("oModel").getObject();var a=0;var s=t.CHAR_NAME,i=t.CHAR_NUM,o=t.CHAR_VALUE,r=t.CHARVAL_NUM;d.selectedDetails={CHAR_NAME:s,CHAR_NUM:i,CHAR_VALUE:o,CHARVAL_NUM:r};if(d.selectedArray.length===0){d.selectedArray.push(d.selectedDetails)}else{for(var l=0;l<d.selectedArray.length;l++){if(d.selectedArray[l].CHAR_NAME===s){var n=d.selectedArray.indexOf(d.selectedArray[l]);d.oIndexArray.push(n)}}if(d.oIndexArray.length>0){for(var l in d.oIndexArray){d.selectedArray.splice(d.oIndexArray[l],1)}}d.selectedArray.push(d.selectedDetails)}}})});