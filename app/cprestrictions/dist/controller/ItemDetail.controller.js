sap.ui.define(["cpapp/cprestrictions/controller/BaseController","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/core/Fragment"],function(e,t,s,i,a,o,n,r){"use strict";var l,d;return e.extend("cpapp.cprestrictions.controller.ItemDetail",{onInit:function(){l=this;this.bus=sap.ui.getCore().getEventBus();l.oModel=new i;l.classnameModel=new i;l.charnameModel=new i;l.charvalueModel=new i;this.oModel.setSizeLimit(1e3);l.classnameModel.setSizeLimit(1e3);l.charnameModel.setSizeLimit(1e3);l.charvalueModel.setSizeLimit(1e3);d=l.getOwnerComponent().getModel("oGModel");this._oCore=sap.ui.getCore()},onAfterRendering:function(){d=l.getOwnerComponent().getModel("oGModel");sap.ui.core.BusyIndicator.show();var e=d.getProperty("/Restriction");this.getModel("BModel").read("/getODHdrRstr",{filters:[new a("RESTRICTION",o.EQ,e)],success:function(e){sap.ui.core.BusyIndicator.hide();l.oModel.setData({results:e.results});l.byId("idDetail").setModel(l.oModel);l.byId("idSearch").setValue("")},error:function(){sap.ui.core.BusyIndicator.hide();t.show("Failed to get data")}})},onItemSearch:function(e){var t="",s=[];if(e){t=e.getParameter("value")||e.getParameter("newValue")}if(t!==""){s.push(new a({filters:[new a("CLASS_NAME",o.Contains,t),new a("CHAR_NAME",o.Contains,t),new a("CHAR_VALUE",o.Contains,t)],and:false}))}l.byId("idDetail").getBinding("items").filter(s)},onCreateItem:function(){l._valueHelpDialogRestItem.open()},onCloseRestItem:function(){l._valueHelpDialogRestItem.close()},onEditItem:function(e){var t=this.byId("idDetail").getItems();this.byId("idUpdateSave").setVisible(true);this.byId("idUpdateCancel").setVisible(true);for(var s=0;s<t.length;s++){t[s].getCells()[4].setEditable(true);t[s].getCells()[5].setEditable(true)}},onCancelUpdate:function(e){var t=this.byId("idDetail").getItems();this.byId("idUpdateSave").setVisible(false);this.byId("idUpdateCancel").setVisible(false);for(var s=0;s<t.length;s++){t[s].getCells()[4].setEditable(false);t[s].getCells()[5].setEditable(false)}},onUpdateItem:function(e){var t=this.byId("idDetail").getItems();var s={RTRCHAR:[]},i;var a="E";for(var o=0;o<t.length;o++){var n=t[o].getBindingContext().getObject();i={RESTRICTION:n.RESTRICTION,CLASS_NUM:n.CLASS_NUM,CHAR_NUM:n.CHAR_NUM,CHARVAL_NUM:n.CHARVAL_NUM,CHAR_COUNTER:n.CHAR_COUNTER,OD_CONDITION:n.OD_CONDITION,ROW_ID:n.ROW_ID};s.RTRCHAR.push(i)}l.getModel("BModel").callFunction("/maintainRestrDet",{method:"GET",urlParameters:{FLAG:a,RTRCHAR:JSON.stringify(s.RTRCHAR)},success:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("success");l.onAfterRendering();l.onCancelUpdate()},error:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("Error")}})},onDeleteItem:function(e){var t={RTRCHAR:[]},s;var i="D";var a=e.getSource().getParent().getBindingContext().getObject();s={RESTRICTION:a.RESTRICTION,CLASS_NUM:a.CLASS_NUM,CHAR_NUM:a.CHAR_NUM,CHARVAL_NUM:a.CHARVAL_NUM,CHAR_COUNTER:a.CHAR_COUNTER};t.RTRCHAR.push(s);l.getModel("BModel").callFunction("/maintainRestrDet",{method:"GET",urlParameters:{FLAG:i,RTRCHAR:JSON.stringify(t.RTRCHAR)},success:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("success");l.onAfterRendering()},error:function(e){sap.ui.core.BusyIndicator.hide();sap.m.MessageToast.show("Error")}})}})});