VIEW V_IBP_SALESH_COMP_LOC_PROD_WEEK_DATE AS
SELECT DISTINCT SALES_DOC, ADD_DAYS (TO_DATE ("MAT_AVAILDATE", 'YYYY-MM-DD'), 6-WEEKDAY (TO_DATE ("MAT_AVAILDATE", 'YYYY-MM-DD'))) AS "WEEK_DATE",
V_IBP_SALESH.LOCATION_ID, V_IBP_SALESH.PRODUCT_ID, CP_BOM_OBJDEPENDENCY.COMPONENT, ORD_QTY
FROM V_IBP_SALESH
INNER JOIN CP_BOM_OBJDEPENDENCY ON
V_IBP_SALESH.LOCATION_ID = CP_BOM_OBJDEPENDENCY.LOCATION_ID 
AND V_IBP_SALESH.PRODUCT_ID = CP_BOM_OBJDEPENDENCY.PRODUCT_ID 
ORDER BY "WEEK_DATE", LOCATION_ID, PRODUCT_ID, COMPONENT;