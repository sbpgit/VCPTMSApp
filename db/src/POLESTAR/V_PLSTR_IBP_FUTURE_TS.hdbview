VIEW V_PLSTR_IBP_FUTURE_TS AS
SELECT DISTINCT WEEK_DATE, IBPFCH.LOCATION_ID, REF_PRODID, 
IBPFCH.PRODUCT_ID AS PARTIAL_ID, PRIMARY_ID,
IBPFCH.CLASS_NUM, IBPFCH.CHAR_NUM, IBPFCH.CHARVAL_NUM, VERSION, SCENARIO,  
OPT_PERCENT, OPT_QTY
FROM CP_IBP_FCHARPLAN AS IBPFCH
INNER JOIN CP_PARTIALPROD_INTRO AS PPI ON 
IBPFCH.PRODUCT_ID = PPI.PRODUCT_ID AND 
IBPFCH.LOCATION_ID = PPI.LOCATION_ID
INNER JOIN CP_PARTIALPROD_CHAR AS PPCH ON
IBPFCH.PRODUCT_ID = PPCH.PRODUCT_ID AND 
IBPFCH.LOCATION_ID = PPCH.LOCATION_ID
INNER JOIN PLSTR_PRIMARY_TIMESERIES AS PIDS ON
REF_PRODID = PIDS.PRODUCT_ID AND
IBPFCH.LOCATION_ID = PIDS.LOCATION_ID AND
IBPFCH.CHARVAL_NUM = PIDS.CHAR_VALUE --CHARVAL_NUM
INNER JOIN CP_CHARACTERISTICS AS CPC ON
IBPFCH.CHAR_NUM = CPC.CHAR_NUM
WHERE 
CPC.CHAR_GROUP = 'PRIMARY' AND
IBPFCH.LOCATION_ID = 'PL20'
-- AND WEEK_DATE = '2022-12-12'
ORDER BY WEEK_DATE, LOCATION_ID, REF_PRODID, PARTIAL_ID, PRIMARY_ID, VERSION, 
SCENARIO, CLASS_NUM, CHAR_NUM, CHARVAL_NUM ASC;