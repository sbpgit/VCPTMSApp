VIEW V_PLSTR_PARTIAL_IDS AS
SELECT DISTINCT
	"PRODUCT_ID" AS PARTIAL_ID,
	"LOCATION_ID",
	"REF_PRODID",
	"CLASS_NUM",
	STRING_AGG("CHAR_NUM",','ORDER BY CHAR_NUM)  AS "PARTIAL_ID_CHAR_NUMS",
	STRING_AGG("CHARVAL_NUM",','ORDER BY CHARVAL_NUM)  AS "PARTIAL_ID_CHARVAL_NUMS"
FROM "V_PARTIALPRODCHAR"
GROUP BY "PRODUCT_ID", "LOCATION_ID","REF_PRODID","CLASS_NUM"
ORDER BY 	"PRODUCT_ID", "LOCATION_ID","REF_PRODID","CLASS_NUM";