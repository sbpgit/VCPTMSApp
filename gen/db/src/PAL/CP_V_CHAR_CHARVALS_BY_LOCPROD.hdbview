VIEW CP_V_CHAR_CHARVALS_BY_LOCPROD AS
SELECT SH.PRODUCT_ID, SH.LOCATION_ID, 
STRING_AGG(SH."CHAR_NUM",','ORDER BY SH.CHAR_NUM)  AS "CHARS",
STRING_AGG(SH."CHARVAL_NUM",','ORDER BY SH.CHARVAL_NUM)  AS "CHARVALS"
FROM CP_V_SALESH_BY_CHAR_CHARVALS AS SH
INNER JOIN CP_CHARACTERISTICS ON
SH.CHAR_NUM = CP_CHARACTERISTICS.CHAR_NUM
GROUP BY SH.SALES_DOC, SH.WEEKDATE, SH.PRODUCT_ID, 
SH.LOCATION_ID
ORDER BY PRODUCT_ID, LOCATION_ID;