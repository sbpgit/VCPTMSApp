VIEW CP_V_UNIQUE_PERCENT_HISTORY AS
SELECT CPP.CAL_DATE, CPP.LOCATION_ID, CPP.PRODUCT_ID, UNIQUE_ID, CPU.PRIMARY_ID, 
UNIQUE_QTY, CPP.PRIMARY_QTY, 100.0 *(UNIQUE_QTY/PRIMARY_QTY) AS UNIQUE_PERCENT, "TYPE"
FROM CP_V_PRIMARY_HISTORY AS CPP
INNER JOIN CP_V_UNIQUE_HISTORY AS CPU ON
CPP.CAL_DATE = CPU.CAL_DATE
AND CPP.LOCATION_ID = CPU.LOCATION_ID
AND CPP.PRODUCT_ID = CPU.PRODUCT_ID
AND CPP.PRIMARY_ID LIKE_REGEXPR  CPU.PRIMARY_ID;