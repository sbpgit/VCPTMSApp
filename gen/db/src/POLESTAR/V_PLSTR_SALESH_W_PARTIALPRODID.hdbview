VIEW V_PLSTR_SALESH_W_PARTIALPRODID AS
SELECT DISTINCT ALLIDS.SALES_DOC, 
ALLIDS.WEEKDATE, ALLIDS.PRODUCT_ID, ALLIDS.LOCATION_ID, 
PARTIAL_ID,  ALLIDS.PARTIAL_ID_CHARS, ALLIDS.PARTIAL_ID_CHARVALS, 
ALLIDS.PRIMARY_ID_CHARS, ALLIDS.PRIMARY_ID_CHARVALS, 
ALLIDS.SCNDRY_ID_CHARS, ALLIDS.SCNDRY_ID_CHARVALS, 
ALLIDS.ORDER_QTY 
FROM V_PLSTR_ALL_IDS_BY_SALESDOC AS ALLIDS
INNER JOIN V_PLSTR_PRIMARY_BY_SALESDOC AS PRID ON
ALLIDS.PRODUCT_ID = PRID.PRODUCT_ID AND
ALLIDS.LOCATION_ID = PRID.LOCATION_ID AND
ALLIDS.PRIMARY_ID_CHARVALS = PRID.PRIMARY_ID_CHARVALS 
INNER JOIN V_PLSTR_PARTIAL_IDS AS PRTID ON
ALLIDS.PRODUCT_ID = PRTID.REF_PRODID AND
ALLIDS.LOCATION_ID = PRTID.LOCATION_ID AND
ALLIDS.PARTIAL_ID_CHARVALS = PRTID.PARTIAL_ID_CHARVAL_NUMS
-- WHERE  ALLIDS.WEEKDATE = '2021-09-27'
GROUP BY ALLIDS.WEEKDATE, ALLIDS.SALES_DOC, ALLIDS.PRODUCT_ID, ALLIDS.LOCATION_ID, PARTIAL_ID, 
  ALLIDS.PARTIAL_ID_CHARS, ALLIDS.PARTIAL_ID_CHARVALS, 
  ALLIDS.PRIMARY_ID_CHARS, ALLIDS.PRIMARY_ID_CHARVALS, 
  ALLIDS.SCNDRY_ID_CHARS, ALLIDS.SCNDRY_ID_CHARVALS, ALLIDS.ORDER_QTY
ORDER BY ALLIDS.WEEKDATE, ALLIDS.SALES_DOC, ALLIDS.PRODUCT_ID, ALLIDS.LOCATION_ID,PARTIAL_ID, 
 ALLIDS.PARTIAL_ID_CHARVALS, 
 ALLIDS.PRIMARY_ID_CHARVALS, ALLIDS.SCNDRY_ID_CHARVALS