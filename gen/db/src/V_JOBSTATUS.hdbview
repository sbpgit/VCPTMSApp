VIEW "V_JOBSTATUS"
AS
SELECT DISTINCT
	JOB_ID,
	JOB_NAME,
	"ACTION",
	JOB_DES,
	SCH_STARTTIME,
	SCH_END_TIME,
	SCH_TIME,
	SCH_NEXTRUN,
	JS_SCHEDULES.RUN_ID,
	RUN_STATUS,
	CASE RUN_STATUS
		WHEN 'COMPLETED' THEN 3
		WHEN 'RUNNING' THEN 2
		WHEN 'SCHEDULED' THEN 0
	END AS CRITICALSTATUS,
	RUN_STATE,
	CASE RUN_STATE
		WHEN 'SUCCESS' THEN 3
		WHEN 'RUNNING' THEN 2
		WHEN 'RUNNING' THEN 2
		WHEN 'ACK_RECVD' THEN 2
		WHEN 'ACK_NOT_RECVD' THEN 2
		WHEN 'UNKNOWN' THEN 0
		WHEN 'SCHEDULED' THEN 0
		WHEN 'ERROR' THEN 1
		WHEN 'REQUEST_ERROR' THEN 1
	END AS CRITICALSTATE,
	STATUS_MESSAGE,
	SCHEDULED_TIMESTAMP,
	COMPLETED_TIMESTAMP,
	RUNTEXT
FROM 
	JS_JOBS
	INNER JOIN
	JS_SCHEDULES
	ON JS_JOBS.SCHEDULE_ID = JS_SCHEDULES.SCHEDULE_ID
	INNER JOIN
	JS_LOGS
	ON JS_SCHEDULES.RUN_ID = JS_LOGS.RUN_ID;
