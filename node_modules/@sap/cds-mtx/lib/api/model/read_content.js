const SecurityHelper = require('../../helper/security_helper');
const Content = require('../../tenant/content');
const Logger = require('../../helper/logger');
const logger = Logger('MODEL');

module.exports = async function readContent(context) {
    const requestedTenantId = await SecurityHelper.checkAuthorization(context, context.data.tenant);
    logger.debug(`Reading content for tenant ID ${requestedTenantId}`);

    const { base, extension } = await Content.getExtension(requestedTenantId);
    const templates = await Content.getTemplateFiles();

    const result = {
        base: [...base],
        extension: [...extension],
        templates: [...templates],
        tenant: context.data.tenant
    };

    return context.data.tenant ? result : [result];
};
