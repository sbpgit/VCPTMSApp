const Runner = require('./runner');

const runners = new Map();

class TenantRunner {

    static async runSynchronized(tenantId, task, ...args) {
        const runner = runners.get(tenantId);
        if (!runner) {
            const newRunner = new Runner(tenantId);
            runners.set(tenantId, newRunner);
            return newRunner.run(task, ...args);
        } else {
            return runner.run(task, ...args);
        }
    }
}

module.exports = TenantRunner;
