# Change Log

All notable changes to this project are documented in this file.

This project adheres to [Semantic Versioning](http://semver.org/) and the changelog is formatted based on [Keep a Changelog](http://keepachangelog.com/).

## What's new with version 1.84

*Official support of OData V4*

## [1.84.35] - 2022-03-31

### Quality

- use `minimist` resolution

## [1.84.34] - 2022-03-31

- upgrade `minimist` version

## [1.84.33] - 2022-03-24

### Added

- OData V4:
  - support of `flexEnabled` property
  - ALP flavor, support of ALP views
  - List report: multiple views, with the right properties

### Changed

### Removed

### Deprecated

### Fixed

- OData V2:
  - duplicated fragment columns were written if table namespace was not found, and unknown custom data in fragment was not considered.
- OData V4
  - custom columns had not been considered when having a 'Before' reference against other custom columns
  - fix overwriting of manifest page content, if page key is changed

### Quality

- Switch to Whitesource Universal Agent
- piper lib upgrade
- Upgrade eslint
- Switch to import type for TS
- Refactoring to resolve sonarQube code smells

## [1.84.32] - 2022-03-09

### Added

- OData V2:
  - visible property is now also available for facets without annotation Id

- OData V4:
  - Support of progress, rating and microchart header facets

### Changed

### Removed

### Deprecated

### Fixed

- OData V2:
  - Creation of new flexChanges now considers resolved Id from pom.xml
- OData V4:
  - Fix overwriting of manifest page id in case of different page key

### Quality

- removed unused dev dependency to `http-server`

## [1.84.31] - 2022-02-23

### Added

- Metadata information `dataType` added to various places in V2 and V4 schemas
- OData V2:
  - display selection fields, and support date settings properties on LR/ALP

### Changed

### Removed

### Deprecated

### Fixed

- OData V2:

### Quality

- Unit test enhancement to run on all platforms
- SonarQube issues

## [1.84.30] - 2022-02-10

### Added

- OData V2:
  - Support column and footer action properties on LR

### Changed

### Removed

### Deprecated

### Fixed

- OData V2:
  - OP: Fix generation of flexChanges for sections with or without ID in annotations
  - Fix issues with sync logic in case of sub object page

### Quality

## [1.84.29] - 2022-01-26

### Added

- OData V2:
  - `exportType` property can now be configured to specify the type of export to be used in the SmartTable control.

### Quality

- Upgrade of node-fetch

## [1.84.28] - 2022-01-12

### Added

- OData V2:
  - OP: properties of footer actions are displayed and supported in side panel
  - properties of toolbar actions are displayed and supported in side panel
  - OVP: The property `showLineItemDetail` is now supported for List and Table cards
  - OP: Schema now supports column extensions for TreeTable

### Changed

- OData V2:
  - property `filterDefaultsFromSelectionVariant` is now only supported for AnalyticalListPage floorplan
  - OVP: The property `tabs` and `addOdataSelect` can now be confirued for all cards
- OData V4:
  - property `afterExecution` of table columns now is only visible for actions but not for other record types

### Removed

- OData V2:
  - OVP: removed `tabs` property from card level

### Deprecated

### Fixed

- OData V2:
  - correct schema generation in case multiple facets are referring to lineitem annotation of same entity
  - Facet Id is considered for import and export of manifest settings
  - Fixed sync issues in case no text is provided for custom columns
- OData V4:
  - Avoid exporting empty arrays to manifest.json

### Quality

- Upgrade of trim-off-newlines
- Upgrade of yarn classic
- New whitesource endpoint
- Upgrade of follow-redirects

## [1.84.27] - 2021-12-01

### Added

- enum support for annotationPath as part of quick variant selection or views
- Property entitySet added to V4 views; enum support for entitySet of multiple views in V2 and V4

### Fixed

- Schemas and configs are now generated for applications without annotations
- V4: Properties of (Header)Sections with missing facet Id are no longer displayed in properties panel
- V4: export of deletion of object page columns did not work

### Quality

- New build version build:dev without generation of documentation html
- Fixed an issue with missing `log` function after webpack

## [1.84.26] - 2021-11-17

### Added

- OData V4: Enhance schema with `dataType`, `annotationPath` information for display on columns, fields and selection fields in Page editor

### Fixed

- Invalid references in generated schemas have been fixed.

## [1.84.25] - 2021-11-03

### Changed

- In the JSON schema, the description of DataPoints as part of sections or header facets now reflects the Title of the target annotation.

### Quality

- Code smell solved: "Define a constant instead of duplicating this literal n times."

## [1.84.24] - 2021-10-20

### Added

- OData V2:
  - Support for (Sub)Section properties: `visible`.
  - ALP: Schema now comprises of entity properties for config `createWithParameterDialog`->`fields`
  - OP: Added support for multiple flex changes in Form and Header Actions
- V2 & V4:
  - Footer actions are now part of the schema. A node for header actions is visible even if there are no actions yet.  

### Changed

- OData V2:
  - Enhanced sync logic to use generic approach for handling unknown properties. As a result sync logic is more robust and handles more unknown properties.

### Removed

- OData V2:
  - OVP: Removed `tab` property from `Stack` and `Link List` cards as view switch control is not supported

### Deprecated

### Fixed

- OData V4:
  - Pages Schema. Exception if path in UI.SelectionFields is not valid.
  - Object page sections referring to UI.Identification with qualifer shall show actions besides the fields.
- V2 & V4:
  - replace alias of namespace definitions of header actions even for references that are not related to OData vocabularies.
  - Add `visible` property to DataField types
- annotationPath definitions of header and footer actions.

### Quality

- Settings for sonarlint have been added
- Upgrade of Annotation Vocabularies Tools
- Fix of code smells reported by SonarQube

## [1.84.23] - 2021-10-18

### Fixed

For some V4 apps, the export of property changes failed due to invalid schema definitions.

## [1.84.22] - 2021-10-06

### Added

- Annotation path com.sap.vocabularies.UI.v1.HeaderInfo added to ObjectPageHeader in V2 and V4.
- Added `i18nClassification` for `title`, `description` properties for `App.json` schema in V2 and V4.
- V4: Header actions are now part of the Object Page schema.
- OData V2:
  - OVP: Added support for property `annotationPath` in Linklist card settings.
  - OVP: property `requireAppAuthorization` is now supported for all card types.

### Changed

- README was updated.
- Order and naming of view nodes for the V2 Object Page adapted.
- Pattern for binding changes in V2: there are now two different patterns for List Report and Object Page; the one for the Object Page  provides the additional enum values  "{ui>/editable}" and "{= !${ui>/editable}}"

### Removed

### Deprecated

### Fixed

- V4: if one section comprises a field group without qualifier, and one referred to UI.Identification, the properties of the field group had been displayed for Identification section of header facet as well.

### Quality

- Fix of vulnerabilities by upgrade of npm modules.
- Fix of bugs nd code smells reported by SonarQube.

## [1.84.21] - 2021-09-22

### Added

- New html files showing a graphical representation of the content of each generic schema.
- OData V2:
  - We show field groups and fiels now as part of the app specific schema, and allow the maintenance of the visible property for fields.
  - Support of property `flexEnabled`on app level.

### Changed

- The default for titles and labels of schema nodes - in case of missing annotation labels - has been adapted, for facets and header facets. There will be node-specific content now in all cases instead of generic defaults like "Form".

### Fixed

- OData V2:
  - Invalid flexChanges are now ignored during sync, hence configs and pages files are created.
- OData V4:
  - Exception occurred in case of invalid custom page definitions in manifest
  - Page determination went wrong in case of irregular ordering of routing targets.

### Quality

- Bugs & code smells removed that had been detected by SonarQube.

## [1.84.20] - 2021-09-08

### Added

- OData V4:
  - Header Facets are now shown in the schemas and configs, along with their actual manifest settings.
- OData V2:
  - OVP: Added support for property `dataPointAnnotationPath` in ListCard settings

### Fixed

- V4: Added export sync for entitySet in custom pages

## [1.84.19] - 2021-08-25

### Added

- OData V4:
  - Enhanced sync logic to avoid export of properties unknown to specification module to avoid modification in manifest.json
- Added test for function `convertInterfaces` to increase test coverage
- Added flexchange layer information to API interface

### Changed

- OData V2: Unresolvable facets are not returned by schema to avoid creation of corrupted custom sections

### Fixed

- Object Page schema generation crash when 'Facets' entry is not defined for 'CollectionFacet'
- Page schema generation - `annotationPath` was missing for `table/toolbar`

### Quality

## [1.84.18] - 2021-08-12

### Added

- OData V2:
  - Added description property to header actions in schema
  - Table toolbar as structure node
  - Added properties showClearOnFB, showFilterConfiguration and showRestoreOnFB to the FilterBar

- OData V4:  
  - Table toolbar as structure node
  - enableOnSelect as property for table toolbar

- Developer guide for contributors to this module  

- Actualization of JS-DOC

- Enhanced error handling of API functions.

- The generic schema is enhanced by the following information:
  - artifact type (manifest setting, flex change or annotation)
  - in case of flex change: control name

### Changed

- The node Selection Fields was renamed to Filter Fields, in accordance with the UI.

- The generic schemas now already comprise anyOf definitions for enums of type string that allow binding changes. Previously this was only added during the generation of app specific schemas.

### Fixed

- A common function was introduced to resolve path references of Common.Label annotations; endless loop references are interjected, the variable value or key is returned in this case.
- Enhance function determineTableType to also check for presence of old tableType flag in manifest.json
- OData V2:
  - ALP: Use correct Id for flex changes generated in case of Filter Bar

### Quality

- Refactor interfaces and class definitions for ALP tables

## [1.84.17] - 2021-07-28

### Added

- OData V2: dateSettings property of Filterbar now supports addtional values
- OData V2: Added growingThreshold property to Responsive Tables

### Fixed

- When starting the app modeler for certain CDS projects, an exception occurs, and no pages nor schemas are listed.
- Modified regex used in binding properties to avoid issues with Shebang plugin during consumption of specification module.

### Quality

- Upgrade of Annotation Vocabularies Tools to version 0.3.28.

## [1.84.16] - 2021-07-14

### Added

- annotationPath is added to the selectionFields node.

### Changed

- The import functions for filling the content of config files are now instantiating the required metadata based on factory classes (that had been introduced for the export before).

### Fixed

- In the annotationPath of columns, qualifiers had not been added.
- The namespace of the entity type is now present in all annotation paths.
- Changing binding value to false removed flex changes from the file system.
- The logic for section generation in app schemas did not consider qualifiers correctly.

### Quality

- Missing path to types in package.json was added. This is required because after introducing bundling with webpack, the index.d.ts file is not next to index-min.js.

## [1.84.15] - 2021-06-30

### Added

- New structure elements at the Filterbar that represent the selection fields resulting from  the UI.SelectionFields annotation.

### Changed

- In the annotationPath information of the generated JSON schemas all alias definitions are now replaced by the full vocabulary name.
- Descriptions in the schema now follow the following paradigm:
  - For facets we need use title and description, the export logic takes the title and extracts the facet key from it for concatenating the stable ID. The text that shall be shown in the Page Editor shall be the description.  
  - Thus we now generalise: all view nodes (isViewNode = true) have a description (but do not necessarily need a title).  
  - Properties (no isViewNode tag) are not listed in the outline, but in the properties panel. Here, the title shall be used as a label, and the description shall be shown on hover (old UI) or rendered directly (new UI).

### Removed

- OData V4: remove initialLoad property from Object Page config

### Fixed

- The deletion of a custom section from the config file was not reflected in manifest.json.
- New page export fails if parent page does not have navigation property defined.
- Navigation is not cleared if we remove last associated page.
- The import of unknow flex change properties into the config is now avoided.
- The export of flex changes sometimes generated multiple flex changes into the dev workspace.
- The script for extracting documentation had neglected patternProperties of the schemas.
- An exception occurred in case of invalid annotation references, the schemas and config files were not generated in this case.
- Too many actions had been listed as table columns: now it is restricted to the inline actions.

## [1.84.14] - 2021-06-17

### Added

- annotationPath added as metadata to the columns in JSON schema.

### Changed

- The enum for fragment names of column extension is more restrictive now, it does not comprise cells anymore.
- Webpack uglify function names

### Fixed

- During the export of V4 configs, manifest sections were created from scratch; this led to a deletion of properties that are not considered (yet) by the specification module.
- Fix for launch config Import project which can be used to debug the import of a project.
- During the export, fragments are not deleted anymore, as they may comprise customer coding.
- If a fragment is not present yet, it gets created now, i.e. added with an <root> prefix to the list of fragments.
- yarn watch allows debugging of custom extensions now, as the templates are available again in the dist folder.
- Correct sync logic to make sure that config changes are written only to desired places in manifest.json.
- An exception had occured in case of invalid target annotation paths, this is caught now.
- OData V4 - Correct sync logic so that custom sections entry in manifest.json gets deleted if entry is deleted from page config
- OData V4 - Correct sync logic, page add was not added if 'navigation' property missing in 'manifest.json'.
- OData V4 - Correct sync logic, page deletion, 'navigation' property was not cleared if there was no an navigation left.
- OData V2 - Flex changes not supported by specification module remain unaffected by the sync logic
- OData V2 - Avoid creation of duplicate flex changes in case of Object Page tables
- OData V2 - ALP: Improved sync logic as some of the supported flex chagnes were not imported to config files

## [1.84.13] - 2021-06-03

### Changed

- The access to reflect metadata is now centralized in factory classes and thus runs in a generic way in most situations.

### Fixed

- Path references of labels had not been resolved correctly. Common.label annotations of the target reference are now considered correctly.
- The regex pattern for binding changes was incomplete, resulting in validation errors.
- OData V4: Enhance sync logic to ensure only properties that are supported by specification module are modified in the manifest.json

### Quality

Upgrades of dependencies to:

- "ts-loader": 9.1.2
- node version 12
- "webpack": 5.37.1
- "chalk": "4.1.1"
- "ejs": "3.1.6"
- "i18next": "20.3.1"
- "ts-json-schema-generator": "0.93.0"

Added resolutions for

- "glob-parent": "^5.1.2"
- "normalize-url": "^6.0.1"
- "ws": "^7.4.6"
- "trim-newlines": "^3.0.1"

## [1.84.12] - 2021-05-20

### Fixed

- The OP V4 schema showed fields and actions only for UI.Identification only if defined without qualifier
- OData V2: Variant Management flex changes are now ignored

## [1.84.11] - 2021-05-06

### Added

- New tag displayName in JSON schema: used to switch the name in the UI when needed, the original schema name is not changed due to compatibility reasons.
- New tag dataType in JSON schema for V4 Form and Object Page: as a tag, this can be rendered display-only as an additional information for any data field.

### Changed

- Documentation updates, due to introduction of the additional version for UI5 1.89
- Schema file names are now based on entitySet instead of entityType

### Fixed

- OData V2: LR/OP/ALP - Unknown properties are now excluded from export which in turn also avoids deletion of properties unknown to specificaiton from manifest
- No invalid references anymore at the generated JSON schemas.

### Quality

- lodash upgrade

## [1.84.10] - 2021-04-22

### Added

- createWithParameterDialog is now also supported for the V2 Object Page

### Changed

- createWithParameterDialog can be found under *table* properties  instead of *toolbarActions* now.

### Fixed

- List report V2: too many properties had been presented at LSP for analytical table

### Quality

- Switch build to webpack
- Upgrade of Annotation-Vocabularies-Tools

## [1.84.9] - 2021-04-15

### Quality

- Upgrade of handlebars

## [1.84.8] - 2021-04-09

### Added

- Actions from the UI.Identification annotation are now represented in the V4 schemas.
- Property inlineDelete for quickVariantSelectionX (table variants)

### Changed

- quickVariantSelection and quickVariantSelectionX definitions are more general no, allowing any number of tabs.

### Fixed

- Missing or incorrect properties for semantic date range control: fields->filter->equals now supports an array of date ranges, not just a single date range value. Additionally, both 'key' and 'category' options support both "equals" and "contains".
- OData V2: ALP - ignoredChartTypes property is now supports more values
- Export of quickVariantSelectionX in V2 was wrong or could lead to exception.

### Quality

- Decrease the number of Eslint warnings

## [1.84.7] - 2021-03-25

### Added

- Forms and the comprised fields and actions are represented in schemas for V4 object pages

### Fixed

- No duplicate entries in the result lists of scripts for extracting documentation

## [1.84.6] - 2021-03-11

### Added

- Property availability for V4 table columns
- Tag isViewNode now marks schema elements that are relevant for setting up an out line or schematic view of a page; (complex) properties are not marked like that.
- Tag i18nClassification marks properties of the schema that are relevent for translation; it uses the key words following the SAP guidelines for translation.
- Forms, field groups and fields of Object Pages are now represented in the V4 schemas.
- Form Entry Object Page support

### Changed

- V4 tables: do not show columns in config that are empty or not maintained at all

### Fixed

- Export of OVP card of the new V4 types to manifest
- V4: Do not throw exception in case of invalid columns listed in manifest, just ignore them
- V4 column keys adjusted: vocabulary alias shall not be part of it
- OVP: Unknown properties are now excluded from export

## [1.84.5] - 2021-02-25

### Added

- Property valueSelectionInfo of OVP cards
- Mark translatable properties in `schema` with `isLanguageDependent` property.
- New Form Entry Object Page added

### Changed

### Fixed

- Exceptions have occurred in case of incomplete or inconsistent annotations. This was solved by a new version of the Annotation Vocabulary Tools that is delivered together with the Specification module.
- Sync now works correctly for property "quickVariantSelectionX"

### Quality

- Switch to Sonar EE

## [1.84.4] - 2021-02-23

### Fixed

- Duplicate property "entitySet" for link list cards got removed

## [1.84.3] - 2021-02-11

### Added

- Manifest settings for (standard) table columns of OData V4 are now supported.
- OData V4: Support of V4 card types in OVP template (table, list and analytical card).
- OData V2: Support of createWithParameterDialog settings for create from the V2 filterbar.

### Fixed

- Overview Page: mandatory fields are clarified and reworked
- Overview Page: obsolete field timeAxis eliminated
- Object Page V4: `layout/sectionLayout` is imported from `manifest.json`
- Object Page V2: `XML` type is only valid type for selection for Custom Section Fragment definition

### Quality

- Upgrade of node modules used

## [1.84.2] - 2021-01-28

### Fixed

- The 'views' definition for OData V4 was not read nor written to the right position at manifest.
- Flex changes for ALP table columns had been written with the wrong selector id and thus had no effect in the run-time.

### Quality

- Dependencies to other npm modules have been actualized

## [1.84.1] - 2021-01-14

### Added

- The specification API now allows passing a logger, i.e. an instance of the new interface ExtensionLogger.
If supplied, all messages resulting from the API processing will be passed to the logger instance instead of console.log.
- Property showDataLabel on global OVP level
- OData V2: New `extensionType` property is added to Custom Column definition.
- OData V2: Support for Custom Columns in Object Page tables.

### Changed

- OData V4: List Report `variantManagement` property is now moved to page level
- The specification API now returns a *complete* list of flex changes, not only the updated ones; if a flex property was not maintained or deleted, you can find it in the list with content.newValue = null. This allows the consuming application to distinguish flex changes that are supported by the JSON schema of the specification from other flex changes that may have been created by other means; only changes that are part of the result list of the API but have content.newValue = null should get deleted from the app.

### Fixed

- OData V2: Export fails to resolve page in `manifest.json` when page key does not contain entitySet.
- OData V4: Switching from FCL to Standard Layout - `manifest.json` -> `sap.ui5/routing/routes/[]/target` was not reseting back

## [1.84.0] - 2020-12-03

### Added

- OData V4: new properties added to the specification for table settings of list report and object page
- OVP custom card - `template` property uses pattern to avoid non-custom card template overlap
- OVP cards - `model` property uses enum entries populated from `manifest.json`

### Changed

- OData V2: Use enum instead of string for property `createWithFilters -> strategy`

### Fixed

- OData V2: Improved sync logic to avoid deletion of entries from page config
- OData V4: Not all properties had been imported into config files
